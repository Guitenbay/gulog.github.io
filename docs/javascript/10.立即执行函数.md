## 介绍

立即执行函数（Immediately Invoked Function Expression，IIFE）是一种 JavaScript 设计模式，它可以用来创建独立的命名空间和封装变量，避免全局作用域中的变量污染和命名冲突。

立即执行函数的基本形式如下：

```javascript
(function () {
  // 这里是立即执行函数内部的代码
})();
```

在这个例子中，我们定义了一个匿名函数，并在函数定义后立即调用它。由于该函数被定义在括号内部，因此它成为一个表达式，而不是一个常规的函数声明，JavaScript 引擎会立即执行这个函数，并将其返回值赋给括号外面的变量。如果这个函数没有返回值，则括号外面的变量将会是 undefined。

立即执行函数通常用来进行一些初始化工作、封装私有变量或**创建局部作用域**等操作。例如，以下是一个使用立即执行函数来创建局部作用域的示例：

```javascript
var x = 10;

(function () {
  var x = 20;
  console.log(x); // 输出 20
})();

console.log(x); // 输出 10
```

在这个例子中，我们定义了一个全局变量 x，并在立即执行函数内部重新定义了同名的局部变量 x，然后输出了局部变量 x 的值。由于立即执行函数内部的变量是局部变量，它不会影响到外部的全局变量 x，因此最终输出的结果分别是 20 和 10。

总之，立即执行函数是一种常用的 JavaScript 设计模式，它可以通过创建独立的命名空间或者封装变量等手段来避免全局作用域中的变量污染和命名冲突问题。但需要注意的是，在使用立即执行函数时，要特别注意函数内部变量的作用域、闭包以及 this 指向等问题，以确保代码的正确性。

## 立即执行函数与闭包

闭包（Closure）与立即执行函数（Immediately Invoked Function Expression，IIFE）是 JavaScript 中两个常用的概念，它们之间有密切的关系。

闭包是指一个函数和其所在环境的组合，该函数可以访问定义在外部函数中的变量，并且这些变量不会在外部函数执行完毕后被销毁。而立即执行函数则是指一个匿名函数定义后立即执行的过程，通常使用 `(function() {...})()` 的形式来实现。

因为立即执行函数是一个匿名函数，它定义的变量只能在自己作用域内访问，所以可以通过立即执行函数来创建一个闭包，将一些私有变量封装在立即执行函数内部，从而避免这些变量污染全局作用域。

例如，以下是一个使用立即执行函数来创建闭包的示例：

```javascript
var counter = (function () {
  var count = 0;
  return function () {
    return ++count;
  };
})();

console.log(counter()); // 输出 1
console.log(counter()); // 输出 2
console.log(counter()); // 输出 3
```

在这个例子中，我们定义了一个立即执行函数并将其返回值赋给变量 counter。该立即执行函数内部定义了一个变量 count，并返回了一个匿名函数，该匿名函数可以访问 count 变量，并将其自增后返回。由于立即执行函数返回的是一个函数，所以变量 counter 实际上是一个闭包，可以持续访问到 count 变量，并且每次调用 counter() 都会将 count 自增一次。

总之，闭包和立即执行函数是两个不同的概念，但它们之间有着紧密的联系。立即执行函数可以用来创建闭包，使得某些变量可以在函数执行完毕后仍然保持其值，从而在 JavaScript 中实现一些高级的编程技巧。
