# D3 基础 <!-- {docsify-ignore} -->

## 介绍

D3 (Data-Driven Documents) 是一个用于创建可交互式数据可视化的 JavaScript 库。它可以帮助开发人员使用 HTML、CSS 和 SVG 来展示和处理数据，通过绑定数据到 DOM 上来实现数据驱动的动态更新。

D3 提供了强大的数据操作和转换功能，包括选择、过滤、排序、分组、聚合等等。同时也提供了丰富多样的图表类型，如折线图、柱状图、散点图、饼图等等，并支持自定义图表类型以及动画效果。

由于 D3 的灵活性和强大的功能，它被广泛应用于各种领域，包括数据分析、数据可视化、科学研究等等。

## 核心思想

D3 提供了一组强大的 API，使得开发者能够轻松地将任意数据与 DOM 元素进行绑定，从而实现数据驱动的文档操作。开发者可以利用这些 API 实现各种各样的数据可视化效果，例如线图、柱状图、散点图、地图等等。

除了数据驱动的文档操作，D3 还提供了丰富的工具和函数库，方便开发者进行数据处理、布局计算、颜色转换、过渡动画等操作，使得开发者能够高效地开发出优秀的数据可视化应用程序。

## 数据绑定

在 D3 中，数据绑定的核心就是使用 data() 方法将数据绑定到 DOM 元素上。

具体来说，数据绑定分为以下几个步骤：

1. 选取要绑定数据的 DOM 元素。可以使用 D3 的选择器（如 d3.select() 或 d3.selectAll()）选取特定的元素。
2. 调用 data() 方法将数据与选中的 DOM 元素进行绑定。例如：selection.data(data)。
3. 可以调用 .enter() 和 .exit() 方法获取新添加的元素和已删除的元素，然后分别处理它们。比如，可以使用 .enter() 方法在数据发生改变时添加新元素；使用 .exit() 方法在数据发生改变时移除不再需要的元素。
4. 最后，可以使用 attr()、style()、text() 等方法设置元素的属性、样式和文本内容，从而动态渲染图表。

以下是一个简单的例子，展示了如何使用 D3 进行数据绑定：

```js
// 假设我们有一组数据
const data = [10, 20, 30, 40, 50];

// 选取一个 HTML 元素，绑定数据
const selection = d3.select("body").selectAll("p").data(data);

// 处理新增的元素
selection
  .enter()
  .append("p")
  .text((d) => `数据值为 ${d}`);

// 处理已有元素的更新
selection.text((d) => `数据值为 ${d}`);

// 处理删除的元素
selection.exit().remove();
```

这段代码会在页面中创建若干个段落元素，每个元素中显示一个数据值。如果数据发生改变，D3 会自动更新页面上的元素，或者添加或删除元素，从而保证数据与可视化图形的同步。

## 常用 API

以下是一些常用的 d3 API：

1. d3.select()：选择文档中的 DOM 元素，例如选择图表容器。
1. d3.selectAll()：选择文档中所有符合条件的 DOM 元素。
1. .append()：在选定的元素内添加子元素。
1. .attr()：设置或获取元素的属性值。
1. .style()：设置或获取元素的样式值。
1. .data()：将数据绑定到选定的元素上。
1. .enter()：返回一个新的选择集，包含数据中没有对应元素的部分。
1. .exit()：返回一个新的选择集，包含文档中没有对应数据的元素。
1. .text()：设置或获取元素的文本内容。
1. .transition()：创建动画效果，让图形变得更加生动。
1. .ease()：设置动画过渡效果的缓冲方法。
1. .scale()：创建比例尺对象，根据数据映射到可视化空间中的位置和大小。
1. .axis()：创建坐标轴对象，用于展示数据的位置和数值。
1. .event()：添加事件监听器，例如鼠标点击、移动等交互行为。

这些 API 可以帮助我们实现各种复杂的数据可视化效果，例如散点图、柱状图、饼图等。
